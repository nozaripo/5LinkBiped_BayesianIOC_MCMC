Variance_Data = matrix(0L, nrow = 1, ncol = N.Comp)
Variance_spcr = matrix(0L, nrow = 1, ncol = N.Comp)
for(i in 1:N.Comp){
Variance_Data[i] = var(X.scaled[,i])
Variance_spcr[i] = var(X.scaled%*%Results.SPCR$loadings.A[,i])
}
Variance_Data_total = sum(Variance_Data)
VAF_spcr = Variance_spcr/Variance_Data_total
View(VAF_spcr)
sort(VAF_spcr)
View(VAF_spcr)
sort(VAF_spcr,decreasing=TRUE)
cumsum(sort(VAF_spcr,decreasing=TRUE))
cumsum(sort(VAF_spcr))
cumsum(sort(VAF_spcr,decreasing=TRUE))
order(VAF_spcr)
?order
order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx]
VAF_spcr_sorted = cumsum(sort(VAF_spcr,decreasing=TRUE))
idx = order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx]
View(Loadings_spcr)
find(VAF_spcr_sorted>.90)
VAF_spcr_sorted>.90
(VAF_spcr_sorted>.90)==True
(VAF_spcr_sorted>.90)=='True'
sum(VAF_spcr_sorted>.90)
sum(VAF_spcr_sorted<.95)
pcr_components = sum(VAF_spcr_sorted<.95)
idx = order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx[1:pcr_components]]
View(Loadings_spcr)
View(VAF_spcr_sorted)
View(as.array(VAF_spcr_sorted))
VAF_spcr_sorted
VAF_spcr_sorted[1,1]
as.matrix(VAF_spcr_sorted)
View(as.matrix(VAF_spcr_sorted))
View(as.matrix(VAF_spcr_sorted).T)
View(as.matrix(VAF_spcr_sorted).t)
View(t(as.matrix(VAF_spcr_sorted))
View(t(as.matrix(VAF_spcr_sorted)))
View(t(as.matrix(VAF_spcr_sorted)))
View(t(as.matrix(VAF_spcr_sorted))[,1:7])
View(t(as.matrix(VAF_spcr_sorted)))
vs=t(as.matrix(VAF_spcr_sorted))
View(vs[1,1:7])
View(vs[,1:7])
View(vs[1:7])
lambda.B = 1000
lambda.gamma = 1000
Results.SPCR = spcr(as.matrix(X), as.vector(y), k, lambda.B, lambda.gamma, w=0.1, xi=0.01,
adaptive=FALSE, center=TRUE, scale=TRUE)
View(Results.SPCR$loadings.A)
lambda.B = 10
lambda.gamma = 1000
Results.SPCR = spcr(as.matrix(X), as.vector(y), k, lambda.B, lambda.gamma, w=0.1, xi=0.01,
adaptive=FALSE, center=TRUE, scale=TRUE)
View(Results.SPCR$loadings.A)
Variance_Data = matrix(0L, nrow = 1, ncol = N.Comp)
Variance_spcr = matrix(0L, nrow = 1, ncol = N.Comp)
for(i in 1:N.Comp){
Variance_Data[i] = var(X.scaled[,i])
Variance_spcr[i] = var(X.scaled%*%Results.SPCR$loadings.A[,i])
}
Variance_Data_total = sum(Variance_Data)
VAF_spcr = Variance_spcr/Variance_Data_total
VAF_spcr_sorted = cumsum(sort(VAF_spcr,decreasing=TRUE))
pcr_components = sum(VAF_spcr_sorted<.95)
idx = order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx[1:pcr_components]]
View(Loadings_spcr)
View(Loadings_spcr)
View(as.array(VAF_spcr_sorted))
View(t(as.matrix(VAF_spcr_sorted))[,1:7])
View(VAF_spcr_sorted)
as.matrix(VAF_spcr_sorted)
lambda.B = 100
lambda.gamma = 1000
Results.SPCR = spcr(as.matrix(X), as.vector(y), k, lambda.B, lambda.gamma, w=0.1, xi=0.01,
adaptive=FALSE, center=TRUE, scale=TRUE)
View(Results.SPCR$loadings.A)
Variance_Data = matrix(0L, nrow = 1, ncol = N.Comp)
Variance_spcr = matrix(0L, nrow = 1, ncol = N.Comp)
for(i in 1:N.Comp){
Variance_Data[i] = var(X.scaled[,i])
Variance_spcr[i] = var(X.scaled%*%Results.SPCR$loadings.A[,i])
}
Variance_Data_total = sum(Variance_Data)
VAF_spcr = Variance_spcr/Variance_Data_total
VAF_spcr_sorted = cumsum(sort(VAF_spcr,decreasing=TRUE))
pcr_components = sum(VAF_spcr_sorted<.95)
idx = order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx[1:pcr_components]]
View(Loadings_spcr)
View(as.array(VAF_spcr_sorted))
View(as.array(VAF_spcr_sorted))
as.matrix(VAF_spcr_sorted)
seq(1,16,1)
View(Loadings_spcr)
lambda.B = 50
lambda.gamma = 1000
Results.SPCR = spcr(as.matrix(X), as.vector(y), k, lambda.B, lambda.gamma, w=0.1, xi=0.01,
adaptive=FALSE, center=TRUE, scale=TRUE)
View(Results.SPCR$loadings.A)
Variance_Data = matrix(0L, nrow = 1, ncol = N.Comp)
Variance_spcr = matrix(0L, nrow = 1, ncol = N.Comp)
for(i in 1:N.Comp){
Variance_Data[i] = var(X.scaled[,i])
Variance_spcr[i] = var(X.scaled%*%Results.SPCR$loadings.A[,i])
}
Variance_Data_total = sum(Variance_Data)
VAF_spcr = Variance_spcr/Variance_Data_total
VAF_spcr_sorted = cumsum(sort(VAF_spcr,decreasing=TRUE))
pcr_components = sum(VAF_spcr_sorted<.95)
idx = order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx[1:pcr_components]]
as.matrix(VAF_spcr_sorted)
lambda.B = 70
lambda.gamma = 1000
Results.SPCR = spcr(as.matrix(X), as.vector(y), k, lambda.B, lambda.gamma, w=0.1, xi=0.01,
adaptive=FALSE, center=TRUE, scale=TRUE)
Variance_Data = matrix(0L, nrow = 1, ncol = N.Comp)
Variance_spcr = matrix(0L, nrow = 1, ncol = N.Comp)
for(i in 1:N.Comp){
Variance_Data[i] = var(X.scaled[,i])
Variance_spcr[i] = var(X.scaled%*%Results.SPCR$loadings.A[,i])
}
Variance_Data_total = sum(Variance_Data)
VAF_spcr = Variance_spcr/Variance_Data_total
VAF_spcr_sorted = cumsum(sort(VAF_spcr,decreasing=TRUE))
pcr_components = sum(VAF_spcr_sorted<.95)
idx = order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx[1:pcr_components]]
as.matrix(VAF_spcr_sorted)
View(Results.SPCR$loadings.A)
#####
View(Loadings_spcr)
par(mfrow=c(1,8))
for(i in seq(1,8,1)){
bar.plt <- barplot(seq(1,16,1),Loadings_spcr[,i],
main = "Maximum Temperatures in a Week",
xlab = "Degree Celsius",
ylab = "Day",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"),
col = "darkred",
horiz = TRUE)
#subplot(bar.plt, nrows = 2, margin = 0.05)
}
par(mfrow=c(1,8))
for(i in seq(1,8,1)){
bar.plt <- barplot(Loadings_spcr[,i],
main = "Maximum Temperatures in a Week",
xlab = "Degree Celsius",
ylab = "Day",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"),
col = "darkred",
horiz = TRUE)
#subplot(bar.plt, nrows = 2, margin = 0.05)
}
par(mfrow=c(1,8))
for(i in seq(1,8,1)){
bar.plt <- barplot(Loadings_spcr[,i],
xlab = "Degree Celsius",
ylab = "Day",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"),
col = "darkred",
horiz = TRUE)
#subplot(bar.plt, nrows = 2, margin = 0.05)
}
par(mfrow=c(1,8))
for(i in seq(1,8,1)){
bar.plt <- barplot(Loadings_spcr[,i],
horiz = TRUE)
#subplot(bar.plt, nrows = 2, margin = 0.05)
}
as.matrix(VAF_spcr_sorted)
pcr_components = 8
idx = order(VAF_spcr,decreasing=TRUE)
Loadings_spcr = Results.SPCR$loadings.A[,idx[1:pcr_components]]
as.matrix(VAF_spcr_sorted)
par(mfrow=c(1,8))
for(i in seq(1,7,1)){
bar.plt <- barplot(Loadings_spcr[,i],
col = "darkred",
horiz = TRUE)
#subplot(bar.plt, nrows = 2, margin = 0.05)
}
i=8
bar.plt <- barplot(Loadings_spcr[,i],
main = "Maximum Temperatures in a Week",
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
horiz = TRUE)
par(mfrow=c(1,8),
xlab = "Loadings of criteria on each PC",
)
par(mfrow=c(1,8),
xlab = "Loadings of criteria on each PC")
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = "Maximum Temperatures in a Week",
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = "PC 1 \n Cum VAF",
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = "PC 1 \n Cum VAF" + format(VAF_spcr_sorted[i], nsmall = 1),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
bar.plt <- barplot(Loadings_spcr[,i],
main = c("PC 1 \n Cum VAF=%s",format(VAF_spcr_sorted[i], nsmall = 1)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
bar.plt <- barplot(Loadings_spcr[,i],
main = c("PC 1 \n Cum VAF=",format(VAF_spcr_sorted[i], nsmall = 1)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = c("PC 1 \n Cum VAF=",format(VAF_spcr_sorted[i], nsmall = 1)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = c("PC 1 \n Cum VAF=",VAF_spcr_sorted[i]),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = ["PC 1 \n Cum VAF=",format(VAF_spcr_sorted[i], nsmall = 1)],
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = "PC 1 \n Cum VAF="+format(VAF_spcr_sorted[i], nsmall = 1),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
for(i in seq(2,8,1)){
bar.plt <- barplot(Loadings_spcr[,i],
col = "darkred",
horiz = TRUE)
#subplot(bar.plt, nrows = 2, margin = 0.05)
}
bar.plt <- barplot(Loadings_spcr[,i],
main = "PC 1 \n Cum VAF="+format(VAF_spcr_sorted[i], nsmall = 1),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = "PC 1 \n Cum VAF="+format(VAF_spcr_sorted[i], nsmall = 1),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = "PC 1 \n Cum VAF="+format(VAF_spcr_sorted[i], nsmall = 1),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = "PC 1 \n Cum VAF= $format(VAF_spcr_sorted[i], nsmall = 1)",
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], nsmall = 1)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 3)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
cex.lab = 2,
cex.axis = 2,
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
cex.lab = 2,
cex.sub = 1.7,
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
cex = 2,
col = "darkred",
las = 2,
horiz = TRUE)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE,
cex = 2)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE,
cex.lab = 2)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE,
cex.lab = 2,
cex.axis = 2,
cex.names = 2)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
xlab = "Loadings of criteria on each PC",
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE,
cex.lab = 1.5,
cex.axis = 1.2,
cex.names = 1.3)
par(mfrow=c(1,8))
i=1
bar.plt <- barplot(Loadings_spcr[,i],
main = paste("PC 1 \n Cum VAF=", format(VAF_spcr_sorted[i], digits = 2)),
ylab = "Criteria",
names.arg = c("Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
"Sun", "Mon"),
col = "darkred",
las = 2,
horiz = TRUE,
cex.lab = 1.7,
cex.axis = 1.2,
cex.names = 1.3)
Criteria.Names = c("ang accel sqr", "ang jerk sqr", "cartes accel sqr", "cartes jerk sqr",
"torqs sqr", "torqs abs", "torqs rate sqr","torqs rate abs", "torq 2nd rate sqr", "torq 2nd rate abs",
"yGRF rate sqr", "xGRF rate sqr", "pos work", "abs work",
"peak kinetic energy", "pk2pk ang momentum")
par(mfrow=c(1,8))
